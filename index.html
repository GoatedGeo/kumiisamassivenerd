<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="png.png" type="image/jpg">
  <title>Berlin Sector: Cultural Influence</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      background: #000;
      color: white;
      height: 100vh;
      overflow: hidden;
      width: 100vw;
      -webkit-tap-highlight-color: transparent;
    }

    .top {
      position: absolute;
      top: 20px;
      width: 100%;
      display: flex;
      justify-content: space-between;
      padding: 0 30px;
      z-index: 5;
      font-size: clamp(16px, 4vw, 20px);
      font-weight: 600;
      font-family: 'Courier New', monospace;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .game {
      display: flex;
      height: 100vh;
      width: 100vw;
      flex-direction: row;
    }

    .side {
      position: relative;
      width: 50%;
      height: 100%;
      overflow: hidden;
      transition: opacity 0.5s ease;
      cursor: pointer;
      border: 2px solid transparent;
    }

    .side:hover {
      border: 2px solid rgba(255, 204, 0, 0.3);
    }

    .side.fade {
      opacity: 0.4;
    }

    .side.disabled {
      cursor: default;
    }

    .side.disabled:hover {
      border: 2px solid transparent;
    }

    .side img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.5s ease;
      background: #111;
    }

    .side.fade img {
      transform: scale(1.05);
    }

    .overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(
        to bottom,
        rgba(0,0,0,0) 0%,
        rgba(0,0,0,0.8) 100%
      );
      pointer-events: none;
    }

    .content {
      position: absolute;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%);
      text-align: center;
      width: 90%;
      max-width: 600px;
      padding: 0 20px;
    }

    .title {
      background: linear-gradient(135deg, #8B0000, #B22222);
      color: #FFD700;
      display: inline-block;
      padding: 12px 20px;
      font-size: clamp(14px, 3vw, 20px);
      font-weight: 600;
      border-radius: 8px;
      margin-bottom: 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      max-width: 100%;
      word-break: break-word;
      line-height: 1.3;
      border: 2px solid #FFD700;
      font-family: 'Courier New', monospace;
      text-transform: uppercase;
    }

    .ups {
      color: #FFD700;
      font-size: clamp(20px, 5vw, 28px);
      font-weight: 800;
      text-shadow: 0 2px 4px rgba(0,0,0,0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      font-family: 'Courier New', monospace;
    }

    .up-icon {
      font-size: clamp(18px, 4vw, 24px);
    }

    .or {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #000;
      color: #FF0000;
      width: 80px;
      height: 80px;
      border-radius: 50%;
      font-weight: 900;
      font-size: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 4;
      box-shadow: 0 4px 20px rgba(255,0,0,0.3);
      border: 4px solid #FF0000;
      pointer-events: none;
      font-family: 'Arial Black', sans-serif;
    }

    .or::before {
      content: "☢";
      font-size: 40px;
      line-height: 1;
    }

    .or::after {
      content: "";
      position: absolute;
      bottom: -25px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 10px;
      color: #FFD700;
      text-shadow: 0 0 5px #FF0000;
      white-space: nowrap;
      letter-spacing: 1px;
    }

    .score-update {
      position: absolute;
      top: 60px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 24px;
      font-weight: 700;
      color: #00FF00;
      opacity: 0;
      transition: all 0.3s ease;
      z-index: 10;
      text-shadow: 0 2px 4px rgba(0,0,0,0.5);
      text-align: center;
      width: 90%;
      font-family: 'Courier New', monospace;
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    .score-update.show {
      opacity: 1;
      top: 80px;
    }

    .score-update.wrong {
      color: #FF0000;
    }

    .footer {
      position: absolute;
      bottom: 10px;
      width: 100%;
      text-align: center;
      color: rgba(255,255,255,0.6);
      font-size: 10px;
      z-index: 5;
      padding: 0 20px;
      font-family: 'Courier New', monospace;
      letter-spacing: 1px;
    }

    /* Instruction text */
    .instruction {
      position: absolute;
      bottom: 40px;
      left: 50%;
      transform: translateX(-50%);
      text-align: center;
      color: #FFD700;
      font-size: 16px;
      font-weight: 600;
      text-shadow: 0 2px 4px rgba(0,0,0,0.8);
      width: 90%;
      max-width: 600px;
      padding: 0 20px;
      z-index: 5;
      pointer-events: none;
      font-family: 'Courier New', monospace;
      text-transform: uppercase;
      background: rgba(139, 0, 0, 0.7);
      padding: 10px 20px;
      border-radius: 5px;
      border: 1px solid #FFD700;
      box-shadow: 0 0 15px rgba(255, 0, 0, 0.5);
    }

    /* Game over video overlay */
    .game-over {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: #000;
      z-index: 100;
      display: none;
    }

    .game-over video {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* Propaganda indicator */
    .propaganda-indicator {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(255, 0, 0, 0.8);
      color: #FFD700;
      padding: 5px 15px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: bold;
      font-family: 'Courier New', monospace;
      text-transform: uppercase;
      letter-spacing: 1px;
      border: 2px solid #FFD700;
      box-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
      display: none;
      z-index: 6;
    }

    /* Mobile-specific styles */
    @media (max-width: 900px) {
      .game {
        flex-direction: column;
      }
      
      .side {
        width: 100%;
        height: 50%;
      }
      
      .or {
        top: 50%;
        width: 60px;
        height: 60px;
        font-size: 12px;
      }
      
      .or::before {
        font-size: 30px;
      }
      
      .or::after {
        font-size: 8px;
        bottom: -20px;
      }
      
      .content {
        bottom: 60px;
      }
      
      .title {
        padding: 10px 16px;
      }
      
      .instruction {
        bottom: 30px;
        font-size: 14px;
        padding: 8px 15px;
      }
      
      .score-update {
        font-size: 20px;
      }
      
      .propaganda-indicator {
        top: 15px;
        font-size: 10px;
        padding: 4px 12px;
      }
    }

    @media (max-width: 600px) {
      .top {
        padding: 0 20px;
      }
      
      .or {
        width: 50px;
        height: 50px;
        font-size: 10px;
        border-width: 3px;
      }
      
      .or::before {
        font-size: 25px;
      }
      
      .or::after {
        font-size: 7px;
        bottom: -18px;
      }
      
      .content {
        bottom: 50px;
      }
      
      .instruction {
        bottom: 20px;
        font-size: 12px;
        padding: 6px 12px;
      }
      
      .propaganda-indicator {
        top: 10px;
        font-size: 9px;
        padding: 3px 10px;
      }
    }

    /* Very small phones */
    @media (max-width: 350px) {
      .instruction {
        font-size: 11px;
        bottom: 15px;
        padding: 5px 10px;
      }
      
      .or {
        width: 40px;
        height: 40px;
      }
      
      .or::before {
        font-size: 20px;
      }
      
      .or::after {
        font-size: 6px;
        bottom: -15px;
      }
    }

    /* Landscape mode for mobile */
    @media (max-height: 500px) and (orientation: landscape) {
      .game {
        flex-direction: row;
      }
      
      .side {
        width: 50%;
        height: 100%;
      }
      
      .or {
        width: 50px;
        height: 50px;
        font-size: 10px;
      }
      
      .or::before {
        font-size: 25px;
      }
      
      .content {
        bottom: 40px;
      }
      
      .title {
        font-size: 12px;
        padding: 8px 12px;
        margin-bottom: 8px;
      }
      
      .ups {
        font-size: 16px;
      }
      
      .instruction {
        bottom: 15px;
        font-size: 11px;
        padding: 5px 10px;
      }
    }
  </style>
</head>
<body>

<div class="top">
  <div>Highest Influence: <span id="highScore">1</span></div>
  <div>Sector Control: <span id="score">0</span></div>
</div>

<div class="propaganda-indicator" id="propagandaIndicator">PROPAGANDA BOOST!</div>

<div class="score-update" id="scoreUpdate"></div>

<div class="game">
  <div class="side" id="sideA" onclick="guessByImage('A')">
    <img id="imgA" alt="Cultural artifact image">
    <div class="overlay"></div>
    <div class="content">
      <div class="title" id="titleA"></div>
      <div class="ups">
        <span class="up-icon">☭</span>
        <span id="upsA"></span>
      </div>
    </div>
  </div>

  <div class="or"></div>

  <div class="side" id="sideB" onclick="guessByImage('B')">
    <img id="imgB" alt="Cultural artifact image">
    <div class="overlay"></div>
    <div class="content">
      <div class="title" id="titleB"></div>
      <div class="ups">
        <span class="up-icon">☭</span>
        <span id="upsB">?</span>
      </div>
    </div>
  </div>
</div>

<div class="instruction" id="instruction">
  Soldier! Identify which cultural artifact has more influence to destabilize the Berlin sector.
</div>

<div class="footer">Cultural Influence Data from West Korean Intelligence • Last updated: 8/2/2026</div>

<div class="game-over" id="gameOver">
  <video id="gameOverVideo" autoplay muted playsinline>
    <source src="audio.mp4" type="video/mp4">
    Your browser does not support the video tag.
  </video>
</div>

<script>
let score = 0;
let highScore = localStorage.getItem('redditHighScore') || 1;
let canGuess = true;
let propagandaAudio = null;
let propagandaIndex = 0;
let audioQueue = ['audio.mp3', 'audio2.mp3', 'audio3.mp3'];

const posts = [
  { title: "losing my mind", ups: 10, image: "https://i.ytimg.com/vi/1dm-JEo9ZbM/oar2.jpg?sqp=-oaymwEoCJUDENAFSFqQAgHyq4qpAxcIARUAAIhC2AEB4gEKCBgQAhgGOAFAAQ==&rs=AOn4CLBzS_inWks1AGKjV0Y2biA4GRYKxQ&usqp=CCk" },
  { title: "funni prank idea | #kumi_jong_orpu on #Twitch", ups: 1, image: "https://i.ytimg.com/vi/ZA_Uo7aF2AA/oar2.jpg?sqp=-oaymwEoCJUDENAFSFqQAgHyq4qpAxcIARUAAIhC2AEB4gEKCBgQAhgGOAFAAQ==&rs=AOn4CLAHufQ_VdTmcnqiSduioRBpgDXvpA&usqp=CCk" },
  { title: "So you should like... czech markiplier | #kumi_jong_orpu on #Twitch", ups: 0, image: "https://i.ytimg.com/vi_webp/CRdNMlfjA9M/oar2.webp?usqp=CCk" },
  { title: "when something finally happens... | #kumi_jong_orpu on #Twitch", ups: 3, image: "https://i.ytimg.com/vi/_6KM7TgZLeY/oar2.jpg?sqp=-oaymwEoCJUDENAFSFqQAgHyq4qpAxcIARUAAIhC2AEB4gEKCBgQAhgGOAFAAQ==&rs=AOn4CLAw8G_Qns9R2agzTI32ZKTxWUrzgw&usqp=CCk" },
  { title: "czech crashout | #kim_jong_pepe on #Twitch", ups: 12, image: "https://i.ytimg.com/vi/CKtIIlQ6QLE/oar2.jpg?sqp=-oaymwEoCJUDENAFSFqQAgHyq4qpAxcIARUAAIhC2AEB4gEKCBgQAhgGOAFAAQ==&rs=AOn4CLBI4PBS5ExB7zTvWPnfvS2Tf2P0hg&usqp=CCk" },
  { title: "yk we can speak english | #kim_jong_pepe on #Twitch", ups: 10, image: "https://i.ytimg.com/vi/zWcogNzvQrw/oar2.jpg?sqp=-oaymwEoCJUDENAFSFqQAgHyq4qpAxcIARUAAIhC2AEB4gEKCBgQAhgGOAFAAQ==&rs=AOn4CLDqfsBN1yYZ9WxlBHkiqJHzLoXMEA&usqp=CCk" },
  { title: "horse bongo, 1 hour version", ups: 101, image: "https://i.ytimg.com/an_webp/Zk6647FtzOI/mqdefault_6s.webp?du=3000&sqp=CLzfocwG&rs=AOn4CLClzNHeVfyutsO5SmlaV0giRTvm8Q" },
  { title: "fish spin brazillian special 8K 180FPS (REAL) (CLICKBAIT)", ups: 7, image: "https://i.ytimg.com/an_webp/GSa67B_2i44/mqdefault_6s.webp?du=3000&sqp=CNzwocwG&rs=AOn4CLB6oxlLIESjmvZSdfO4pzZH6g4GRg" },
  { title: "TOP 10 MONKEYS", ups: 10, image: "https://i.ytimg.com/an_webp/D-tXv2KrRHE/mqdefault_6s.webp?du=3000&sqp=CODTocwG&rs=AOn4CLCUUHEuaPdJDyMsdteUxM18knCgNw" },
];

let currentPost = null;
let nextPost = null;

function randomPost() {
  const randomIndex = Math.floor(Math.random() * posts.length);
  return { ...posts[randomIndex] };
}

function getUniqueNextPost() {
  let newPost = randomPost();
  if (currentPost) {
    let attempts = 0;
    while (newPost.title === currentPost.title && attempts < 10) {
      newPost = randomPost();
      attempts++;
    }
  }
  return newPost;
}

function updateScores() {
  document.getElementById('score').textContent = score;
  document.getElementById('highScore').textContent = highScore;
}

function showScoreUpdate(text, isCorrect) {
  const scoreUpdate = document.getElementById('scoreUpdate');
  scoreUpdate.textContent = text;
  scoreUpdate.className = 'score-update show';
  if (!isCorrect) {
    scoreUpdate.classList.add('wrong');
  }
  
  setTimeout(() => {
    scoreUpdate.classList.remove('show');
    setTimeout(() => {
      scoreUpdate.classList.remove('wrong');
    }, 300);
  }, 1000);
}

function playPropaganda() {
  // Show propaganda indicator
  const indicator = document.getElementById('propagandaIndicator');
  indicator.style.display = 'block';
  indicator.style.animation = 'none';
  indicator.offsetHeight; // Trigger reflow
  indicator.style.animation = null;
  
  // Play propaganda audio
  if (audioQueue[propagandaIndex]) {
    propagandaAudio = new Audio(audioQueue[propagandaIndex]);
    propagandaAudio.volume = 0.7;
    propagandaAudio.play().catch(e => console.log('Audio play failed:', e));
    
    // Cycle to next audio
    propagandaIndex = (propagandaIndex + 1) % audioQueue.length;
    
    // Hide indicator after 3 seconds
    setTimeout(() => {
      indicator.style.display = 'none';
    }, 3000);
  }
}

function showGameOver() {
  const gameOver = document.getElementById('gameOver');
  const video = document.getElementById('gameOverVideo');
  
  gameOver.style.display = 'block';
  
  // Try to play video with sound
  video.muted = false;
  video.play().catch(e => {
    console.log('Video play failed:', e);
    // Fallback: try muted
    video.muted = true;
    video.play();
  });
  
  // Restart game after video ends
  video.onended = function() {
    gameOver.style.display = 'none';
    initGame();
  };
  
  // Also allow restart by clicking
  gameOver.onclick = function() {
    video.pause();
    gameOver.style.display = 'none';
    initGame();
  };
  
  // Auto-restart after 10 seconds if video doesn't end
  setTimeout(() => {
    if (gameOver.style.display === 'block') {
      video.pause();
      gameOver.style.display = 'none';
      initGame();
    }
  }, 10000);
}

function handleImageError(img) {
  img.src = 'https://via.placeholder.com/400x300/333/666?text=INFLUENCE+CLASSIFIED';
}

function render() {
  const titleA = document.getElementById('titleA');
  const upsA = document.getElementById('upsA');
  const imgA = document.getElementById('imgA');
  const titleB = document.getElementById('titleB');
  const upsB = document.getElementById('upsB');
  const imgB = document.getElementById('imgB');
  const sideA = document.getElementById('sideA');
  const sideB = document.getElementById('sideB');

  if (currentPost) {
    titleA.textContent = currentPost.title;
    upsA.textContent = currentPost.ups.toLocaleString();
    imgA.onerror = () => handleImageError(imgA);
    imgA.src = currentPost.image;
  }

  if (nextPost) {
    titleB.textContent = nextPost.title;
    upsB.textContent = "?";
    upsB.classList.remove('reveal');
    imgB.onerror = () => handleImageError(imgB);
    imgB.src = nextPost.image;
  }

  sideA.classList.remove('fade', 'disabled');
  sideB.classList.remove('fade', 'disabled');
}

function guessByImage(sideClicked) {
  if (!canGuess) return;
  
  const isSideA = sideClicked === 'A';
  const clickedPost = isSideA ? currentPost : nextPost;
  const otherPost = isSideA ? nextPost : currentPost;
  
  const correct = (clickedPost.ups >= otherPost.ups);
  
  processGuess(correct);
}

function processGuess(isCorrect) {
  canGuess = false;
  const sides = document.querySelectorAll('.side');
  sides.forEach(side => side.classList.add('disabled'));
  
  const upsB = document.getElementById('upsB');
  const sideA = document.getElementById('sideA');
  const sideB = document.getElementById('sideB');
  
  upsB.textContent = nextPost.ups.toLocaleString();
  upsB.classList.add('reveal');
  
  if (isCorrect) {
    score++;
    if (score > highScore) {
      highScore = score;
      localStorage.setItem('redditHighScore', highScore);
    }
    showScoreUpdate('SECTOR SECURED +1', true);
    
    // Play propaganda every 5 points
    if (score > 0 && score % 5 === 0) {
      setTimeout(() => {
        playPropaganda();
      }, 500);
    }
  } else {
    showScoreUpdate('BERLIN SECTOR LOST!', false);
    
    // Show game over video
    setTimeout(() => {
      showGameOver();
    }, 1500);
    
    score = 0;
  }
  
  updateScores();
  
  sideA.classList.add('fade');
  sideB.classList.add('fade');
  
  if (isCorrect) {
    setTimeout(() => {
      currentPost = nextPost;
      nextPost = getUniqueNextPost();
      
      render();
      
      canGuess = true;
      sides.forEach(side => side.classList.remove('disabled'));
    }, 1500);
  }
}

// Initialize
function initGame() {
  currentPost = randomPost();
  nextPost = getUniqueNextPost();
  score = 0;
  canGuess = true;
  updateScores();
  render();
  
  // Hide game over video if visible
  document.getElementById('gameOver').style.display = 'none';
  document.getElementById('gameOverVideo').pause();
  document.getElementById('gameOverVideo').currentTime = 0;
}

// Add keyboard shortcuts
document.addEventListener('keydown', (e) => {
  if (!canGuess) return;
  
  if (e.key === 'ArrowLeft' || e.key === 'a' || e.key === 'A') {
    guessByImage('A');
  } else if (e.key === 'ArrowRight' || e.key === 'd' || e.key === 'D') {
    guessByImage('B');
  }
});

// Add visual feedback for clicks
document.querySelectorAll('.side').forEach(side => {
  side.addEventListener('touchstart', function() {
    if (!this.classList.contains('disabled')) {
      this.style.opacity = '0.9';
    }
  });
  
  side.addEventListener('touchend', function() {
    if (!this.classList.contains('disabled')) {
      this.style.opacity = '';
    }
  });
  
  side.addEventListener('mousedown', function() {
    if (!this.classList.contains('disabled')) {
      this.style.opacity = '0.9';
    }
  });
  
  side.addEventListener('mouseup', function() {
    if (!this.classList.contains('disabled')) {
      this.style.opacity = '';
    }
  });
  
  side.addEventListener('mouseleave', function() {
    this.style.opacity = '';
  });
});

// Preload video for immediate playback
window.addEventListener('load', function() {
  const video = document.getElementById('gameOverVideo');
  video.load();
  
  // Initialize game
  initGame();
});

// Add animation for propaganda indicator
const style = document.createElement('style');
style.textContent = `
  @keyframes propagandaPulse {
    0% { transform: translateX(-50%) scale(1); box-shadow: 0 0 10px rgba(255, 0, 0, 0.5); }
    50% { transform: translateX(-50%) scale(1.1); box-shadow: 0 0 20px rgba(255, 0, 0, 0.8); }
    100% { transform: translateX(-50%) scale(1); box-shadow: 0 0 10px rgba(255, 0, 0, 0.5); }
  }
  
  .propaganda-indicator {
    animation: propagandaPulse 0.5s ease-in-out;
  }
`;
document.head.appendChild(style);
</script>

</body>
</html>